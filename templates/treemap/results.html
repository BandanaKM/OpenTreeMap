{% extends "template_1.html" %}
{% load dynamic_attribute thumbnail %}

{% block extrahead %}	    
    {% load compressed %}
    {% compressed_js 'map' %}

{% endblock %}

{%block body_class%}inner{%endblock %}
{% block body_id %}id="results"{% endblock %} 
    
            {% block heading %}
			<!-- START TREEMAP/RESULTS.HTML -->
                <div class="heading">
                    <div class="holder">
                        <ul id="resultsContainer">
                            <li id="totals">
                                <ul>
                                    <li id="title">Results:</li>
                                    <li id="first"><span class="tree_count">0</span> trees selected <span class="notrees"></span></li> 
                                    <!-- <li>XX trees need more info to be included</li> -->
                                    <li id="addTreeBtn"><a class="btn btn-success" href="{% url treemap.views.tree_add %}">Add a tree!</a></li>
                                </ul>
                            </li>
                            {% if user.is_superuser %}
			    <li id="export">
                                <ul>
                                    <li id="title">Export options:</li>
                                    <li id="firstOption"><a id="kml_link">KML</a></li> 
                                    <li><a id="csv_link">CSV</a></li>
                                    <li><a id="shp_link">Shapefile</a></li> 
                                </ul>
                            </li>
                            {% endif %}
                        </ul>
                    </div>
                </div>
            {% endblock heading %}


    

        {% block top_left_panel %}
        
            <div id="results_aside" class="aside">
            <h2>Yearly Eco Impact</h2>
            <div id="summary_subset">Selected trees in <span id="summary_subset_val">..</span></div>
              <!-- <strong class="sub-title">Based on select data. <a href="{% url treemap.views.tree_add %}">Add a tree &raquo;</a></strong> -->
            
            <div id="results_wrapper" style="display:none;">
                <ul id="messageStats">
                    <li class="impact" id="cost">Total Benefits</li>
                    <li class="impactStat">&pound;<span id="benefits_total"></span><span class="subnote"> saved</span></li>
                </ul>
                <ul id="messageStats">
                    <li class="impact" id="gas">Greenhouse Gas Benefits</li>
                    <li class="impactStat"><span id="annual_co2_reduced"> </span> kgs CO2 <span class="subnote">reduced</span></li>
                    <li class="impactStat">&pound;<span id="benefits_greenhouse"> </span><span class="subnote"> saved</span></li>
                </ul>
                <ul id="messageStats">
                    <li class="impact" id="water">Water Benefits</li>
                    <li class="impactStat"><span id="annual_stormwater_management"></span> litres <span class="subnote">conserved</span></li>
                    <li class="impactStat">&pound;<span id="benefits_water"> </span><span class="subnote"> saved</span></li>
                </ul>
                <ul id="messageStats">
                    <li class="impact" id="energy">Energy Benefits</li>
                    <li class="impactStat"><span id="annual_energy_conserved"> </span> kWh <span class="subnote">conserved</span></li>
                    <li class="impactStat">&pound;<span id="benefits_energy"> </span><span class="subnote"> saved</span></li>
                </ul>
                <ul id="messageStats">
                    <li class="impact" id="air">Air Quality Benefits</li>
                    <li class="impactStat"><span id="annual_air_quality_improvement"></span> kgs pollutants <span class="subnote">reduced</span></li>
                    <li class="impactStat">&pound;<span id="benefits_air_quality"> </span><span class="subnote"> saved</span></li>
                </ul>
            </div>
            </div>
        
        {% endblock %}

        {% block top_right_panel %}
            <div id="results_map">
				<div class="mapToggle buttomSm btn btn-inverse btn-mini">View Satellite</div>
				<div id="eco-test">
					<div id="eco-test-content">
					<h3>Yearly Eco Impact</h3>
					</div>
				</div>
            </div>
        {% endblock %}        
        
     
{% block bottom_left_panel %}
        <div class="span6" id="recent-updates"> 
			<h3>Recent updates</h3> 
			<p>Our database of trees comes from public records and citizen foresters like you. Your help will make it better.</p> 
			<table class="table" width="100%"> 
			{% for tree in latest_trees %}
				<tr> 
					<td class="image"><a href="{% url treemap_tree_detail tree.id %}">
					{% if tree.last_updated_by.get_profile.photo %}
                    {% thumbnail tree.last_updated_by.get_profile.photo "32x32" crop="center" as image %}
						<img src="{{image.url}}" alt="image description" width="33" height="32" />
                    {% endthumbnail %}
					{% else %}
						<img src="{{ STATIC_URL }}images/v2/defaultuser.gif" alt="image description" width="33" height="32" />            
					{% endif %}
					</td>  
					<td> 
						<span>Neighborhood</span>  <br />
						{{tree.neighborhood.all.0}} 
					</td> 
					<td> 
						<span>Tree species</span>  <br />
						<em>{{tree.species.common_name}}</em> 
					</td> 
					<td> 
						<span>Updated by</span>  <br />
						<a href="{% url profiles.views.profile_detail tree.last_updated_by.username %}">{{ tree.last_updated_by.username }}</a> 
					</td> 
				</tr>
		{% endfor %}
        </table> 
    </div>       
{% endblock bottom_left_panel %}

{% block bottom_right_panel %}
        <div class="span5" id="recent-photos"> 
        <h3>Recent photos from users</h3> 
            <ul class="photos">
            {% for pic in latest_photos %}
                <li>
                    <a href="{% url treemap_tree_detail pic.tree.id %}">
                        {% thumbnail pic.photo "43x42" as image %}
                        <img src="{{ image.url }}" alt="image description" width="43" height="42" />
                        {% endthumbnail %}
                    </a>
                </li>
            {% endfor %}
            </ul>
        </div> 
{% endblock bottom_right_panel %}

{% block endpage %}
	<script type="text/javascript">
		//jQuery().ready(function() {
			tm.resultsTemplatePageLoad({{min_year}}, {{current_year}}, {{min_updated}}, {{max_updated}}, 0, '15+');
		//});
	</script>
{% endblock endpage %}

